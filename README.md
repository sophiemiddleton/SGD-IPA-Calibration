# SGD.cc
Code written as basic model for an incremental Stochastic Gradient Descent (SGD) Minimizer. The idea here is to minimize for "weights" which are in fact calibration constants for each of the calorimeter's crystals. This is currently just dummy code but it converges, it needs a lot of improvements before becoming used in practice.

Current Implementation:
  - 2 structs are present:
    - Each "Event" has a "crystal list" and a "track energy" associated with it.
    - Each "Crystal List" has an associated list of crystal indices and energy deposited in that crystal.
  - The energy is a randomly chosen value based on Gaussian between 40-50, error is 3 MeV, these were taken from simulation
  - cluster size is a random interger chosen again to be Gaussian and centred on 4, std=1, this is taken from simulaiton
  - The hit at which the energy was deposited is a random number in a flat distribtuoin between 0-674
  - The Edep of each hit is evenly distributed between all crystals in the event. This needs to be improved so we can test biases there.
  - Fake random offsets are generated by a flat disibribution between 0,1.
  - The fit is seeded by a faked Raw calibration data which can be made more or less acurate.
  - A loss function is defined as F a cumulative sum over all events computed at the start and end of each crystal list i.e. event
  - The gradient is calculated analytically from partial derivatives for each C_i
  - A step size has not been optimized
  - For each event the minimization rountine is applied be N_ITERATIONS
  -The fit is converged if it has < N_ITERATIONS and if F < MAX_FUCNTION. There must also be criteria on dc and dc-seedc but this is still needing to be optimized.
  -At the end the residuals for all crystals relative to the true offsets input are output to screen
  -The N_EVENTS can be changed 10000 shows good results, <100 many crystals get no hits. I would say at least 10000 needed.
